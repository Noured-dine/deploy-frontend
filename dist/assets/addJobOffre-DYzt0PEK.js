import{r as c,s as I,j as e,F as i,I as u,S as r,T as p,D as J,a as Q,b as g,U as y,c as Z,d as K,C as X,R as Y,B as f,e as ee,f as te,g as ie,h as se,i as le,k as ne,p as ae,u as re}from"./index-BrqhHR6u.js";const ce=()=>{const A=t=>new Promise((s,n)=>{const a=new FileReader;a.readAsDataURL(t),a.onload=()=>s(a.result),a.onerror=h=>n(h)}),[L,b]=c.useState(!1),[_,w]=c.useState(""),q=async t=>{!t.url&&!t.preview&&(t.preview=await A(t.originFileObj)),w(t.url||t.preview),b(!0)},B=e.jsxs("button",{style:{border:0,background:"none"},type:"button",children:[e.jsx(ne,{}),e.jsx("div",{style:{marginTop:8},children:"Ajouter Image"})]}),[l,j]=c.useState(0),[S,T]=I.useMessage(),[D,W]=I.useMessage(),[F,C]=c.useState(!1);c.useEffect(()=>{F===!0?D.open({key:"loading",type:"loading",content:"Postulation en cours..",duration:0}):D.destroy()},[F]);const d=t=>{S.open({key:"error",type:"error",content:t})},R=t=>{S.open({type:"success",content:t})},[o,N]=c.useState({villes:[],secteurs_activite:[],fonctions:[]}),[v,k]=c.useState([]),V=t=>t.type==="image/jpeg"||t.type==="image/png"?t.size/1024/1024<5?!1:(d("Le fichier doit faire moins de 5 Mo !"),y.LIST_IGNORE):(d("Seuls les fichiers jpeg ou png sont autorisés !"),y.LIST_IGNORE),z=({fileList:t})=>{k(t)},M=t=>{k(s=>s.filter(n=>n.uid!==t.uid))},P=async()=>{if(v.length===0)return 1;const t=new FormData;t.append("file",v[0].originFileObj);try{const s=await re(t);return s.result||(s.status===401?d("Votre session a expiré. Veuillez vous reconnecter.."):d("Nous rencontrons des problèmes, veuillez ressayer plus tard !")),s.logo_id}catch(s){return console.error(s),!1}};c.useEffect(()=>{(async()=>{const s=await le();N(s)})()},[]);const O=()=>{d("Vérifier que vous avez bien entrer les données")},$=async t=>{console.log(t.deadline_postulation);try{C(!0);const s=await P();if(!s){console.error("erreur");return}const n={...t};for(let x in n)(n[x]===void 0||Array.isArray(n[x])&&n[x].length===0)&&(n[x]=null);const a=new Date(t.deadline_postulation.$y,t.deadline_postulation.$M,t.deadline_postulation.$D,23,59),h=await ae({...n,fichier_id:s,deadline_postulation:a});h.result?R("Votre offre est bien ajouté!"):h.status===401?d("Votre session a expiré. Veuillez vous reconnecter.."):d("Nous rencontrons des problèmes, veuillez ressayer plus tard !")}catch(s){console.error(s)}finally{C(!1)}},E={required:"${label} est obligatoire!"},H=()=>{j(t=>t-1)},U=()=>{j(t=>t+1)},m=[{icon:e.jsx(Q,{style:{width:"24px",color:l===0?"#1890ff":l<0?"#666":"green"}}),key:"Informations sur l'offre",content:e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"16px",fontWeight:"600",color:"#666",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Informations sur l'offre"}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Titre"}),name:"titre",hasFeedback:!0,validateDebounce:1e3,rules:[{required:!0,message:"Le titre est obligatoire"},{pattern:/^[a-zA-Z0-9_'/\"\s]{2,35}$/,message:"Titre incovenable"}],children:e.jsx(u,{placeholder:"ex. Développeur Junior H/F"})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Télétravail"}),name:"teletravail",required:!0,initialValue:"Non",children:e.jsx(r,{id:"teletravailField",options:[{value:"Non",label:"Non"},{value:"Oui",label:"Oui"},{value:"Hybride",label:"Hybride"}]})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Niveau d'étude"}),name:"niveau_etude_requis",required:!0,initialValue:"Qualification avant Bac",children:e.jsx(r,{id:"niveau_etude_requisField",options:[{value:"Qualification avant Bac",label:"Qualification avant Bac"},{value:"Autodidacte",label:"Autodidacte"},{value:"Bac",label:"Bac"},{value:"Bac +1",label:"Bac +1"},{value:"Bac +2",label:"Bac +2"},{value:"Bac +3",label:"Bac +3"},{value:"Bac +4",label:"Bac +4"},{value:"Bac +5 et plus",label:"Bac +5 et plus"}]})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Diplome"}),name:"diplome_requis",required:!0,initialValue:null,children:e.jsx(r,{id:"diplome_requisField",options:[{value:null,label:"Aucun diplôme / Niveau scolaire"},{value:"Diplôme de technicien (DT)",label:"Diplôme de technicien (DT)"},{value:"Diplôme de technicien spécialisé (DTS)",label:"Diplôme de technicien spécialisé (DTS)"},{value:"Baccalauréat",label:"Baccalauréat"},{value:"Licence",label:"Licence"},{value:"Master",label:"Master"},{value:"Doctorat",label:"Doctorat"}]})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Type de contrat"}),name:"type_offre",required:!0,initialValue:"Autre contrat",children:e.jsx(r,{id:"type_offreField",options:[{value:"Autre contrat",label:"Autre"},{value:"CDD",label:"CDD"},{value:"CDI",label:"CDI"},{value:"Intérim",label:"Intérim"},{value:"Stage",label:"Stage"},{value:"Freelance",label:"Freelance"}]})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Ville"}),name:"id_ville_offre",required:!0,initialValue:1,children:e.jsx(r,{id:"id_ville_offreField",showSearch:!0,options:o?.villes?[...o.villes.map(t=>({value:t.id,label:t.nom_ville}))]:[]})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Secteur d'activté"}),name:"id_secteur_activite",required:!0,initialValue:1,children:e.jsx(r,{id:"id_secteur_activiteField",showSearch:!0,options:o?.secteurs_activite?[...o.secteurs_activite.map(t=>({value:t.id,label:t.nom_secteur}))]:[]})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Fonction"}),name:"id_fonction",required:!0,initialValue:1,children:e.jsx(r,{id:"id_fonctionField",showSearch:!0,options:o?.fonctions?[...o.fonctions.map(t=>({value:t.id,label:t.nom_fonction}))]:[]})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Nombre d'employés demandé"}),name:"nbr_employes_demande",required:!0,initialValue:1,children:e.jsx(p,{min:1,style:{width:"50%"}})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Salaire minimum"}),name:"salaire_min",children:e.jsx(p,{min:1,placeholder:"Non défini",style:{width:"50%"}})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Salaire maximum"}),name:"salaire_max",children:e.jsx(p,{min:1,placeholder:"Non défini",style:{width:"50%"}})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Minimum d'années d'expérience"}),name:"annee_experience_min",children:e.jsx(p,{min:1,placeholder:"Non défini",style:{width:"50%"}})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Maximum d'années d'expérience"}),name:"annee_experience_max",children:e.jsx(p,{min:1,placeholder:"Non défini",style:{width:"50%"}})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Description"}),name:"description",children:e.jsx(u.TextArea,{maxLength:1e3,placeholder:"description sur l'offre.."})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Date limite de Postulation"}),name:"deadline_postulation",rules:[{required:!0,message:"La date limite de postulation est obligatoire"}],children:e.jsx(J,{style:{width:"50%"}})})]})},{icon:e.jsx(K,{style:{width:"24px",color:l===1?"#1890ff":l<1?"#666":"green"}}),key:"Informations sur l'entreprise",content:e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"16px",fontWeight:"600",color:"#666",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Informations sur l'entreprise"}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Nom du l'entreprise"}),name:"nom_entreprise",rules:[{required:!0,message:"Le nom du l'entreprise est obligatoire"},{pattern:/^[a-zA-Z0-9_\-'\s]{2,15}$/,message:"Nom incovenable"}],hasFeedback:!0,validateDebounce:1e3,children:e.jsx(u,{placeholder:"ex. Capgemini"})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Ville"}),name:"ville_id_entreprise",required:!0,initialValue:1,children:e.jsx(r,{id:"id_ville_entreprise_Field",showSearch:!0,options:o?.villes?[...o.villes.map(t=>({value:t.id,label:t.nom_ville}))]:[]})}),e.jsx(i,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Adresse"}),name:"adresse",children:e.jsx(u.TextArea,{maxLength:50,placeholder:"adresse du l'entreprise.."})}),e.jsxs(g.Item,{label:e.jsx("span",{style:{fontWeight:"600"},children:"Logo du l'entreprise"}),children:[e.jsx(y,{name:"logo",maxCount:1,multiple:!1,beforeUpload:V,fileList:v,listType:"picture-card",onChange:z,onRemove:M,accept:".jpeg,.png",onPreview:q,children:B}),_&&e.jsx(Z,{wrapperStyle:{display:"none"},preview:{visible:L,onVisibleChange:t=>b(t),afterOpenChange:t=>!t&&w("")},src:_})]})]})},{icon:e.jsx(ee,{style:{width:"24px",color:l===2?"#1890ff":l<2?"#666":"green"}}),key:"Compétences requises",content:e.jsxs("div",{children:[e.jsx("p",{style:{fontSize:"16px",fontWeight:"600",color:"#666",textTransform:"uppercase",letterSpacing:"0.5px"},children:"Compétences requises        "}),e.jsx(g.List,{name:"competences",children:(t,{add:s,remove:n})=>e.jsxs("div",{style:{display:"flex",rowGap:16,flexDirection:"column"},children:[t.map(a=>e.jsxs(X,{size:"small",title:`Comptence ${a.name+1}`,extra:e.jsx(Y,{onClick:()=>{n(a.name)}}),children:[e.jsx(i,{name:[a.name,"nom_competence"],rules:[{required:!0,message:"Le nom du competence à inserer est obligatoire"},{pattern:/^[a-zA-Z\s]{5,15}$/,message:"Nom incovenable"}],hasFeedback:!0,validateDebounce:1e3,children:e.jsx(u,{placeholder:"ex. Java"})}),e.jsx(i,{name:[a.name,"niveau"],required:!0,initialValue:null,children:e.jsx(r,{id:"niveauField",options:[{value:null,label:"Niveau non requis"},{value:"Novice",label:"Novice"},{value:"Intermédiaire",label:"Intermédiaire"},{value:"Avancé",label:"Avancé"}]})})]},a.key)),e.jsx(f,{type:"dashed",onClick:()=>s(),block:!0,children:"+ Ajouter une comptence"})]})}),e.jsx("div",{})]})}],G=t=>{j(t)};return e.jsxs("div",{style:{padding:"1rem"},children:[e.jsxs(te,{children:[e.jsx("h1",{style:{fontWeight:"bold",fontSize:"30px"},children:"Créer un offre d'emploi"}),e.jsx("p",{style:{color:"gray",marginBottom:"3rem"},children:"Remplissez les informations pour publier votre offre"})," "]}),e.jsxs(ie,{theme:{token:{colorPrimary:"#52c41a"}},children:[" ",e.jsx(se,{current:l,onChange:G,items:m,style:{width:"80%",marginLeft:"auto",marginRight:"auto"}})," "]}),e.jsxs(g,{onFinishFailed:O,onFinish:$,layout:"vertical",validateMessages:E,style:{marginLeft:"auto",marginRight:"auto",width:"50%"},children:[T," ",W,e.jsxs("div",{style:{backgroundColor:" #f9fafb",borderRadius:"0.75rem",padding:" 1.5rem",marginBottom:"2rem",marginTop:"2rem"},children:[e.jsx("div",{style:{display:l===0?"block":"none"},children:m[0].content}),e.jsx("div",{style:{display:l===1?"block":"none"},children:m[1].content}),e.jsx("div",{style:{display:l===2?"block":"none"},children:m[2].content})," "]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx(f,{type:"primary",disabled:l===0,onClick:H,children:"Précédent"}),e.jsx(f,{type:"primary",style:{display:l===2?"none":"block"},onClick:U,children:"Suivant"}),e.jsx(f,{type:"primary",htmlType:"submit",style:{backgroundColor:"rgba(22, 163, 88, 1)",display:l===2?"block":"none"},children:"Publier"})]})]})]})};export{ce as default};
